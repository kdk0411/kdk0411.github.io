---
layout: single
title:  "SL#03"
---
# 와인등급예측


## 데이터셋 정보 확인


```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

data = pd.read_csv('wine.csv')
data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>alcohol</th>
      <th>malic_acid</th>
      <th>ash</th>
      <th>alcalinity_of_ash</th>
      <th>magnesium</th>
      <th>total_phenols</th>
      <th>flavanoids</th>
      <th>nonflavanoid_phenols</th>
      <th>proanthocyanins</th>
      <th>color_intensity</th>
      <th>hue</th>
      <th>od280/od315_of_diluted_wines</th>
      <th>proline</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>14.23</td>
      <td>1.71</td>
      <td>2.43</td>
      <td>15.6</td>
      <td>127</td>
      <td>2.80</td>
      <td>3.06</td>
      <td>0.28</td>
      <td>2.29</td>
      <td>5.64</td>
      <td>1.04</td>
      <td>3.92</td>
      <td>1065</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>1.78</td>
      <td>2.14</td>
      <td>11.2</td>
      <td>100</td>
      <td>2.65</td>
      <td>2.76</td>
      <td>0.26</td>
      <td>1.28</td>
      <td>4.38</td>
      <td>1.05</td>
      <td>3.40</td>
      <td>1050</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>13.16</td>
      <td>2.36</td>
      <td>2.67</td>
      <td>18.6</td>
      <td>101</td>
      <td>2.80</td>
      <td>3.24</td>
      <td>0.30</td>
      <td>2.81</td>
      <td>5.68</td>
      <td>1.03</td>
      <td>3.17</td>
      <td>1185</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>14.37</td>
      <td>1.95</td>
      <td>2.50</td>
      <td>16.8</td>
      <td>113</td>
      <td>3.85</td>
      <td>3.49</td>
      <td>0.24</td>
      <td>2.18</td>
      <td>7.80</td>
      <td>0.86</td>
      <td>3.45</td>
      <td>1480</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>13.24</td>
      <td>2.59</td>
      <td>2.87</td>
      <td>21.0</td>
      <td>118</td>
      <td>2.80</td>
      <td>2.69</td>
      <td>0.39</td>
      <td>1.82</td>
      <td>4.32</td>
      <td>1.04</td>
      <td>2.93</td>
      <td>735</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 178 entries, 0 to 177
    Data columns (total 14 columns):
     #   Column                        Non-Null Count  Dtype  
    ---  ------                        --------------  -----  
     0   alcohol                       176 non-null    float64
     1   malic_acid                    178 non-null    float64
     2   ash                           178 non-null    float64
     3   alcalinity_of_ash             178 non-null    float64
     4   magnesium                     178 non-null    int64  
     5   total_phenols                 178 non-null    float64
     6   flavanoids                    178 non-null    float64
     7   nonflavanoid_phenols          173 non-null    float64
     8   proanthocyanins               178 non-null    float64
     9   color_intensity               178 non-null    float64
     10  hue                           178 non-null    float64
     11  od280/od315_of_diluted_wines  178 non-null    float64
     12  proline                       178 non-null    int64  
     13  class                         178 non-null    int64  
    dtypes: float64(11), int64(3)
    memory usage: 19.6 KB
    

    데이터의 정보를 잘 보면 178이 아닌 숫자들이 보인다. 이는 각가 결측치가 2,5인 것을 기억하자.


```python
data['class'].unique()
```




    array([0, 1, 2], dtype=int64)




```python
data['class'].nunique()
```




    3




```python
data['class'].value_counts()
```




    1    71
    0    59
    2    48
    Name: class, dtype: int64




```python
sns.barplot(x=data['class'].value_counts().index, y=data['class'].value_counts())
```




    <Axes: ylabel='class'>




    
![png](output_8_1.png)
    


    위 그래프는 이전과 달리 막대 그래프로 표현했다.
    산점도로 표현할 이유도 없거니와 Class의 counts가 3이였기 때문에 이와같이 표현하는것이
    가독성에 유리하기 때문이다.
    
    하지만 위 코드를 잘 이해해보면 굳이 길게 쓸 이유가 없다.
    짧게 다시 작성해보자


```python
data.isna() # 값을 결측치 여부에 따라 True or False로 표현
# data.isnull() 도 같은 표현이 가능하다.
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>alcohol</th>
      <th>malic_acid</th>
      <th>ash</th>
      <th>alcalinity_of_ash</th>
      <th>magnesium</th>
      <th>total_phenols</th>
      <th>flavanoids</th>
      <th>nonflavanoid_phenols</th>
      <th>proanthocyanins</th>
      <th>color_intensity</th>
      <th>hue</th>
      <th>od280/od315_of_diluted_wines</th>
      <th>proline</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>173</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>174</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>175</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>176</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>177</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>178 rows × 14 columns</p>
</div>



    위에 사용한 isna()는 결측치일 경우 True로 표현하는 것이다.
    이를 사용하여 결측치를 쉽게 확인이 가능하다.
    처음 사용한 head()에서는 결측치를 NaN으로 표현하였다.


```python
data.sum()
```




    alcohol                           2286.080000
    malic_acid                         415.870000
    ash                                421.240000
    alcalinity_of_ash                 3470.100000
    magnesium                        17754.000000
    total_phenols                      408.530000
    flavanoids                         361.210000
    nonflavanoid_phenols                62.690000
    proanthocyanins                    283.180000
    color_intensity                    900.339999
    hue                                170.426000
    od280/od315_of_diluted_wines       464.880000
    proline                         132947.000000
    class                              167.000000
    dtype: float64



    isna()(isnull())과 sum을 결합하여 사용하면 True의 개수를 합한 값이 출력될 것이다.
    왜냐하면 기본적으로 True는 1을 False는 0을 표현하기 때문에 True의 값만큼 합한 값이 나온다는 것이다.


```python
data.isna().sum()
```




    alcohol                         2
    malic_acid                      0
    ash                             0
    alcalinity_of_ash               0
    magnesium                       0
    total_phenols                   0
    flavanoids                      0
    nonflavanoid_phenols            5
    proanthocyanins                 0
    color_intensity                 0
    hue                             0
    od280/od315_of_diluted_wines    0
    proline                         0
    class                           0
    dtype: int64




```python
data.isnull().sum()
```




    alcohol                         2
    malic_acid                      0
    ash                             0
    alcalinity_of_ash               0
    magnesium                       0
    total_phenols                   0
    flavanoids                      0
    nonflavanoid_phenols            5
    proanthocyanins                 0
    color_intensity                 0
    hue                             0
    od280/od315_of_diluted_wines    0
    proline                         0
    class                           0
    dtype: int64




```python
data.isna().mean()
```




    alcohol                         0.011236
    malic_acid                      0.000000
    ash                             0.000000
    alcalinity_of_ash               0.000000
    magnesium                       0.000000
    total_phenols                   0.000000
    flavanoids                      0.000000
    nonflavanoid_phenols            0.028090
    proanthocyanins                 0.000000
    color_intensity                 0.000000
    hue                             0.000000
    od280/od315_of_diluted_wines    0.000000
    proline                         0.000000
    class                           0.000000
    dtype: float64



    위와 같이 isna()와 mean()을 결합하여 결측치의 평균을 확인할 수 있다.
    alcohol의 경우 1.12%를 nonflavanoid_phenols의 경우는 2.8%의 결측치가 확인된다.

## 결측치 제거

### 1. 결측치 행 제거 -> dropna()


```python
data.dropna() # 결측치가 있는 행 제거
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>alcohol</th>
      <th>malic_acid</th>
      <th>ash</th>
      <th>alcalinity_of_ash</th>
      <th>magnesium</th>
      <th>total_phenols</th>
      <th>flavanoids</th>
      <th>nonflavanoid_phenols</th>
      <th>proanthocyanins</th>
      <th>color_intensity</th>
      <th>hue</th>
      <th>od280/od315_of_diluted_wines</th>
      <th>proline</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>14.23</td>
      <td>1.71</td>
      <td>2.43</td>
      <td>15.6</td>
      <td>127</td>
      <td>2.80</td>
      <td>3.06</td>
      <td>0.28</td>
      <td>2.29</td>
      <td>5.64</td>
      <td>1.04</td>
      <td>3.92</td>
      <td>1065</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>13.16</td>
      <td>2.36</td>
      <td>2.67</td>
      <td>18.6</td>
      <td>101</td>
      <td>2.80</td>
      <td>3.24</td>
      <td>0.30</td>
      <td>2.81</td>
      <td>5.68</td>
      <td>1.03</td>
      <td>3.17</td>
      <td>1185</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>14.37</td>
      <td>1.95</td>
      <td>2.50</td>
      <td>16.8</td>
      <td>113</td>
      <td>3.85</td>
      <td>3.49</td>
      <td>0.24</td>
      <td>2.18</td>
      <td>7.80</td>
      <td>0.86</td>
      <td>3.45</td>
      <td>1480</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>13.24</td>
      <td>2.59</td>
      <td>2.87</td>
      <td>21.0</td>
      <td>118</td>
      <td>2.80</td>
      <td>2.69</td>
      <td>0.39</td>
      <td>1.82</td>
      <td>4.32</td>
      <td>1.04</td>
      <td>2.93</td>
      <td>735</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>14.20</td>
      <td>1.76</td>
      <td>2.45</td>
      <td>15.2</td>
      <td>112</td>
      <td>3.27</td>
      <td>3.39</td>
      <td>0.34</td>
      <td>1.97</td>
      <td>6.75</td>
      <td>1.05</td>
      <td>2.85</td>
      <td>1450</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>173</th>
      <td>13.71</td>
      <td>5.65</td>
      <td>2.45</td>
      <td>20.5</td>
      <td>95</td>
      <td>1.68</td>
      <td>0.61</td>
      <td>0.52</td>
      <td>1.06</td>
      <td>7.70</td>
      <td>0.64</td>
      <td>1.74</td>
      <td>740</td>
      <td>2</td>
    </tr>
    <tr>
      <th>174</th>
      <td>13.40</td>
      <td>3.91</td>
      <td>2.48</td>
      <td>23.0</td>
      <td>102</td>
      <td>1.80</td>
      <td>0.75</td>
      <td>0.43</td>
      <td>1.41</td>
      <td>7.30</td>
      <td>0.70</td>
      <td>1.56</td>
      <td>750</td>
      <td>2</td>
    </tr>
    <tr>
      <th>175</th>
      <td>13.27</td>
      <td>4.28</td>
      <td>2.26</td>
      <td>20.0</td>
      <td>120</td>
      <td>1.59</td>
      <td>0.69</td>
      <td>0.43</td>
      <td>1.35</td>
      <td>10.20</td>
      <td>0.59</td>
      <td>1.56</td>
      <td>835</td>
      <td>2</td>
    </tr>
    <tr>
      <th>176</th>
      <td>13.17</td>
      <td>2.59</td>
      <td>2.37</td>
      <td>20.0</td>
      <td>120</td>
      <td>1.65</td>
      <td>0.68</td>
      <td>0.53</td>
      <td>1.46</td>
      <td>9.30</td>
      <td>0.60</td>
      <td>1.62</td>
      <td>840</td>
      <td>2</td>
    </tr>
    <tr>
      <th>177</th>
      <td>14.13</td>
      <td>4.10</td>
      <td>2.74</td>
      <td>24.5</td>
      <td>96</td>
      <td>2.05</td>
      <td>0.76</td>
      <td>0.56</td>
      <td>1.35</td>
      <td>9.20</td>
      <td>0.61</td>
      <td>1.60</td>
      <td>560</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>171 rows × 14 columns</p>
</div>




```python
data.dropna().isna().mean() #  결측치 제거 확인
```




    alcohol                         0.0
    malic_acid                      0.0
    ash                             0.0
    alcalinity_of_ash               0.0
    magnesium                       0.0
    total_phenols                   0.0
    flavanoids                      0.0
    nonflavanoid_phenols            0.0
    proanthocyanins                 0.0
    color_intensity                 0.0
    hue                             0.0
    od280/od315_of_diluted_wines    0.0
    proline                         0.0
    class                           0.0
    dtype: float64



    dropna()는 결과를 출력하는 것이지 data의 값을 변경하지는 않는다는 것에 주의하자
    저장하고자 한다면 변수에 담거나 inplace=True를 넣어 사용하면 된다.
    또한 모두 제거하는 것이 아닌 특정 변수만 지정하여 제거가 가능하다.
    이때는 dropna(subset=['지정변수'])로 사용하면 된다.

### 2. 결측 변수 제거 -> drop()


```python
data.drop(['alcohol', 'nonflavanoid_phenols'], axis=1) # 변수 제거
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>malic_acid</th>
      <th>ash</th>
      <th>alcalinity_of_ash</th>
      <th>magnesium</th>
      <th>total_phenols</th>
      <th>flavanoids</th>
      <th>proanthocyanins</th>
      <th>color_intensity</th>
      <th>hue</th>
      <th>od280/od315_of_diluted_wines</th>
      <th>proline</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.71</td>
      <td>2.43</td>
      <td>15.6</td>
      <td>127</td>
      <td>2.80</td>
      <td>3.06</td>
      <td>2.29</td>
      <td>5.64</td>
      <td>1.04</td>
      <td>3.92</td>
      <td>1065</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.78</td>
      <td>2.14</td>
      <td>11.2</td>
      <td>100</td>
      <td>2.65</td>
      <td>2.76</td>
      <td>1.28</td>
      <td>4.38</td>
      <td>1.05</td>
      <td>3.40</td>
      <td>1050</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.36</td>
      <td>2.67</td>
      <td>18.6</td>
      <td>101</td>
      <td>2.80</td>
      <td>3.24</td>
      <td>2.81</td>
      <td>5.68</td>
      <td>1.03</td>
      <td>3.17</td>
      <td>1185</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.95</td>
      <td>2.50</td>
      <td>16.8</td>
      <td>113</td>
      <td>3.85</td>
      <td>3.49</td>
      <td>2.18</td>
      <td>7.80</td>
      <td>0.86</td>
      <td>3.45</td>
      <td>1480</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.59</td>
      <td>2.87</td>
      <td>21.0</td>
      <td>118</td>
      <td>2.80</td>
      <td>2.69</td>
      <td>1.82</td>
      <td>4.32</td>
      <td>1.04</td>
      <td>2.93</td>
      <td>735</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>173</th>
      <td>5.65</td>
      <td>2.45</td>
      <td>20.5</td>
      <td>95</td>
      <td>1.68</td>
      <td>0.61</td>
      <td>1.06</td>
      <td>7.70</td>
      <td>0.64</td>
      <td>1.74</td>
      <td>740</td>
      <td>2</td>
    </tr>
    <tr>
      <th>174</th>
      <td>3.91</td>
      <td>2.48</td>
      <td>23.0</td>
      <td>102</td>
      <td>1.80</td>
      <td>0.75</td>
      <td>1.41</td>
      <td>7.30</td>
      <td>0.70</td>
      <td>1.56</td>
      <td>750</td>
      <td>2</td>
    </tr>
    <tr>
      <th>175</th>
      <td>4.28</td>
      <td>2.26</td>
      <td>20.0</td>
      <td>120</td>
      <td>1.59</td>
      <td>0.69</td>
      <td>1.35</td>
      <td>10.20</td>
      <td>0.59</td>
      <td>1.56</td>
      <td>835</td>
      <td>2</td>
    </tr>
    <tr>
      <th>176</th>
      <td>2.59</td>
      <td>2.37</td>
      <td>20.0</td>
      <td>120</td>
      <td>1.65</td>
      <td>0.68</td>
      <td>1.46</td>
      <td>9.30</td>
      <td>0.60</td>
      <td>1.62</td>
      <td>840</td>
      <td>2</td>
    </tr>
    <tr>
      <th>177</th>
      <td>4.10</td>
      <td>2.74</td>
      <td>24.5</td>
      <td>96</td>
      <td>2.05</td>
      <td>0.76</td>
      <td>1.35</td>
      <td>9.20</td>
      <td>0.61</td>
      <td>1.60</td>
      <td>560</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>178 rows × 12 columns</p>
</div>



### 3. 결측값 채우기 -> fillna()


```python
data.fillna(-99) # 결측치를 -99로 변경
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>alcohol</th>
      <th>malic_acid</th>
      <th>ash</th>
      <th>alcalinity_of_ash</th>
      <th>magnesium</th>
      <th>total_phenols</th>
      <th>flavanoids</th>
      <th>nonflavanoid_phenols</th>
      <th>proanthocyanins</th>
      <th>color_intensity</th>
      <th>hue</th>
      <th>od280/od315_of_diluted_wines</th>
      <th>proline</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>14.23</td>
      <td>1.71</td>
      <td>2.43</td>
      <td>15.6</td>
      <td>127</td>
      <td>2.80</td>
      <td>3.06</td>
      <td>0.28</td>
      <td>2.29</td>
      <td>5.64</td>
      <td>1.04</td>
      <td>3.92</td>
      <td>1065</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-99.00</td>
      <td>1.78</td>
      <td>2.14</td>
      <td>11.2</td>
      <td>100</td>
      <td>2.65</td>
      <td>2.76</td>
      <td>0.26</td>
      <td>1.28</td>
      <td>4.38</td>
      <td>1.05</td>
      <td>3.40</td>
      <td>1050</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>13.16</td>
      <td>2.36</td>
      <td>2.67</td>
      <td>18.6</td>
      <td>101</td>
      <td>2.80</td>
      <td>3.24</td>
      <td>0.30</td>
      <td>2.81</td>
      <td>5.68</td>
      <td>1.03</td>
      <td>3.17</td>
      <td>1185</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>14.37</td>
      <td>1.95</td>
      <td>2.50</td>
      <td>16.8</td>
      <td>113</td>
      <td>3.85</td>
      <td>3.49</td>
      <td>0.24</td>
      <td>2.18</td>
      <td>7.80</td>
      <td>0.86</td>
      <td>3.45</td>
      <td>1480</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>13.24</td>
      <td>2.59</td>
      <td>2.87</td>
      <td>21.0</td>
      <td>118</td>
      <td>2.80</td>
      <td>2.69</td>
      <td>0.39</td>
      <td>1.82</td>
      <td>4.32</td>
      <td>1.04</td>
      <td>2.93</td>
      <td>735</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>173</th>
      <td>13.71</td>
      <td>5.65</td>
      <td>2.45</td>
      <td>20.5</td>
      <td>95</td>
      <td>1.68</td>
      <td>0.61</td>
      <td>0.52</td>
      <td>1.06</td>
      <td>7.70</td>
      <td>0.64</td>
      <td>1.74</td>
      <td>740</td>
      <td>2</td>
    </tr>
    <tr>
      <th>174</th>
      <td>13.40</td>
      <td>3.91</td>
      <td>2.48</td>
      <td>23.0</td>
      <td>102</td>
      <td>1.80</td>
      <td>0.75</td>
      <td>0.43</td>
      <td>1.41</td>
      <td>7.30</td>
      <td>0.70</td>
      <td>1.56</td>
      <td>750</td>
      <td>2</td>
    </tr>
    <tr>
      <th>175</th>
      <td>13.27</td>
      <td>4.28</td>
      <td>2.26</td>
      <td>20.0</td>
      <td>120</td>
      <td>1.59</td>
      <td>0.69</td>
      <td>0.43</td>
      <td>1.35</td>
      <td>10.20</td>
      <td>0.59</td>
      <td>1.56</td>
      <td>835</td>
      <td>2</td>
    </tr>
    <tr>
      <th>176</th>
      <td>13.17</td>
      <td>2.59</td>
      <td>2.37</td>
      <td>20.0</td>
      <td>120</td>
      <td>1.65</td>
      <td>0.68</td>
      <td>0.53</td>
      <td>1.46</td>
      <td>9.30</td>
      <td>0.60</td>
      <td>1.62</td>
      <td>840</td>
      <td>2</td>
    </tr>
    <tr>
      <th>177</th>
      <td>14.13</td>
      <td>4.10</td>
      <td>2.74</td>
      <td>24.5</td>
      <td>96</td>
      <td>2.05</td>
      <td>0.76</td>
      <td>0.56</td>
      <td>1.35</td>
      <td>9.20</td>
      <td>0.61</td>
      <td>1.60</td>
      <td>560</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>178 rows × 14 columns</p>
</div>




```python
data.fillna(data.mean()) # 평균값으로 결측치 채우기
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>alcohol</th>
      <th>malic_acid</th>
      <th>ash</th>
      <th>alcalinity_of_ash</th>
      <th>magnesium</th>
      <th>total_phenols</th>
      <th>flavanoids</th>
      <th>nonflavanoid_phenols</th>
      <th>proanthocyanins</th>
      <th>color_intensity</th>
      <th>hue</th>
      <th>od280/od315_of_diluted_wines</th>
      <th>proline</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>14.230000</td>
      <td>1.71</td>
      <td>2.43</td>
      <td>15.6</td>
      <td>127</td>
      <td>2.80</td>
      <td>3.06</td>
      <td>0.28</td>
      <td>2.29</td>
      <td>5.64</td>
      <td>1.04</td>
      <td>3.92</td>
      <td>1065</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12.989091</td>
      <td>1.78</td>
      <td>2.14</td>
      <td>11.2</td>
      <td>100</td>
      <td>2.65</td>
      <td>2.76</td>
      <td>0.26</td>
      <td>1.28</td>
      <td>4.38</td>
      <td>1.05</td>
      <td>3.40</td>
      <td>1050</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>13.160000</td>
      <td>2.36</td>
      <td>2.67</td>
      <td>18.6</td>
      <td>101</td>
      <td>2.80</td>
      <td>3.24</td>
      <td>0.30</td>
      <td>2.81</td>
      <td>5.68</td>
      <td>1.03</td>
      <td>3.17</td>
      <td>1185</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>14.370000</td>
      <td>1.95</td>
      <td>2.50</td>
      <td>16.8</td>
      <td>113</td>
      <td>3.85</td>
      <td>3.49</td>
      <td>0.24</td>
      <td>2.18</td>
      <td>7.80</td>
      <td>0.86</td>
      <td>3.45</td>
      <td>1480</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>13.240000</td>
      <td>2.59</td>
      <td>2.87</td>
      <td>21.0</td>
      <td>118</td>
      <td>2.80</td>
      <td>2.69</td>
      <td>0.39</td>
      <td>1.82</td>
      <td>4.32</td>
      <td>1.04</td>
      <td>2.93</td>
      <td>735</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>173</th>
      <td>13.710000</td>
      <td>5.65</td>
      <td>2.45</td>
      <td>20.5</td>
      <td>95</td>
      <td>1.68</td>
      <td>0.61</td>
      <td>0.52</td>
      <td>1.06</td>
      <td>7.70</td>
      <td>0.64</td>
      <td>1.74</td>
      <td>740</td>
      <td>2</td>
    </tr>
    <tr>
      <th>174</th>
      <td>13.400000</td>
      <td>3.91</td>
      <td>2.48</td>
      <td>23.0</td>
      <td>102</td>
      <td>1.80</td>
      <td>0.75</td>
      <td>0.43</td>
      <td>1.41</td>
      <td>7.30</td>
      <td>0.70</td>
      <td>1.56</td>
      <td>750</td>
      <td>2</td>
    </tr>
    <tr>
      <th>175</th>
      <td>13.270000</td>
      <td>4.28</td>
      <td>2.26</td>
      <td>20.0</td>
      <td>120</td>
      <td>1.59</td>
      <td>0.69</td>
      <td>0.43</td>
      <td>1.35</td>
      <td>10.20</td>
      <td>0.59</td>
      <td>1.56</td>
      <td>835</td>
      <td>2</td>
    </tr>
    <tr>
      <th>176</th>
      <td>13.170000</td>
      <td>2.59</td>
      <td>2.37</td>
      <td>20.0</td>
      <td>120</td>
      <td>1.65</td>
      <td>0.68</td>
      <td>0.53</td>
      <td>1.46</td>
      <td>9.30</td>
      <td>0.60</td>
      <td>1.62</td>
      <td>840</td>
      <td>2</td>
    </tr>
    <tr>
      <th>177</th>
      <td>14.130000</td>
      <td>4.10</td>
      <td>2.74</td>
      <td>24.5</td>
      <td>96</td>
      <td>2.05</td>
      <td>0.76</td>
      <td>0.56</td>
      <td>1.35</td>
      <td>9.20</td>
      <td>0.61</td>
      <td>1.60</td>
      <td>560</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>178 rows × 14 columns</p>
</div>



    결측치를 제거하는 3가지 방법을 알아보았다.
    내 생각에는 drop을 사용하는것이 가장 합리적인것 같다.
    dropna를 사용할때도 변수를 지정하여 제거하는 방법이 있는것을 미루어 보아
    drop이 결국 가장 많이 사용될 것 같다.

## 결측치 처리


```python
data.fillna(data.median(), inplace=True) # 결측치를 중윗값으로 채우기
```


```python
data.isna().mean() # 결측치 확인
```




    alcohol                         0.0
    malic_acid                      0.0
    ash                             0.0
    alcalinity_of_ash               0.0
    magnesium                       0.0
    total_phenols                   0.0
    flavanoids                      0.0
    nonflavanoid_phenols            0.0
    proanthocyanins                 0.0
    color_intensity                 0.0
    hue                             0.0
    od280/od315_of_diluted_wines    0.0
    proline                         0.0
    class                           0.0
    dtype: float64



## 스케일링


```python
from sklearn.preprocessing import StandardScaler, MinMaxScaler, RobustScaler
st_scaler = StandardScaler()
st_scaler.fit(data)
st_scaled = st_scaler.transform(data)
st_scaled
```




    array([[ 1.55484903, -0.5622498 ,  0.23205254, ...,  1.84791957,
             1.01300893, -1.21394365],
           [ 0.07550273, -0.49941338, -0.82799632, ...,  1.1134493 ,
             0.96524152, -1.21394365],
           [ 0.21340789,  0.02123125,  1.10933436, ...,  0.78858745,
             1.39514818, -1.21394365],
           ...,
           [ 0.35131305,  1.74474449, -0.38935541, ..., -1.48544548,
             0.28057537,  1.37386437],
           [ 0.22594472,  0.22769377,  0.01273209, ..., -1.40069891,
             0.29649784,  1.37386437],
           [ 1.4294807 ,  1.58316512,  1.36520822, ..., -1.42894777,
            -0.59516041,  1.37386437]])




```python
pd.DataFrame(st_scaled)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.554849</td>
      <td>-0.562250</td>
      <td>0.232053</td>
      <td>-1.169593</td>
      <td>1.913905</td>
      <td>0.808997</td>
      <td>1.034819</td>
      <td>-0.658865</td>
      <td>1.224884</td>
      <td>0.251717</td>
      <td>0.362177</td>
      <td>1.847920</td>
      <td>1.013009</td>
      <td>-1.213944</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.075503</td>
      <td>-0.499413</td>
      <td>-0.827996</td>
      <td>-2.490847</td>
      <td>0.018145</td>
      <td>0.568648</td>
      <td>0.733629</td>
      <td>-0.820072</td>
      <td>-0.544721</td>
      <td>-0.293321</td>
      <td>0.406051</td>
      <td>1.113449</td>
      <td>0.965242</td>
      <td>-1.213944</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.213408</td>
      <td>0.021231</td>
      <td>1.109334</td>
      <td>-0.268738</td>
      <td>0.088358</td>
      <td>0.808997</td>
      <td>1.215533</td>
      <td>-0.497658</td>
      <td>2.135968</td>
      <td>0.269020</td>
      <td>0.318304</td>
      <td>0.788587</td>
      <td>1.395148</td>
      <td>-1.213944</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.730365</td>
      <td>-0.346811</td>
      <td>0.487926</td>
      <td>-0.809251</td>
      <td>0.930918</td>
      <td>2.491446</td>
      <td>1.466525</td>
      <td>-0.981279</td>
      <td>1.032155</td>
      <td>1.186068</td>
      <td>-0.427544</td>
      <td>1.184071</td>
      <td>2.334574</td>
      <td>-1.213944</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.313703</td>
      <td>0.227694</td>
      <td>1.840403</td>
      <td>0.451946</td>
      <td>1.281985</td>
      <td>0.808997</td>
      <td>0.663351</td>
      <td>0.227773</td>
      <td>0.401404</td>
      <td>-0.319276</td>
      <td>0.362177</td>
      <td>0.449601</td>
      <td>-0.037874</td>
      <td>-1.213944</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>173</th>
      <td>0.902934</td>
      <td>2.974543</td>
      <td>0.305159</td>
      <td>0.301803</td>
      <td>-0.332922</td>
      <td>-0.985614</td>
      <td>-1.424900</td>
      <td>1.275618</td>
      <td>-0.930179</td>
      <td>1.142811</td>
      <td>-1.392758</td>
      <td>-1.231206</td>
      <td>-0.021952</td>
      <td>1.373864</td>
    </tr>
    <tr>
      <th>174</th>
      <td>0.514292</td>
      <td>1.412609</td>
      <td>0.414820</td>
      <td>1.052516</td>
      <td>0.158572</td>
      <td>-0.793334</td>
      <td>-1.284344</td>
      <td>0.550187</td>
      <td>-0.316950</td>
      <td>0.969783</td>
      <td>-1.129518</td>
      <td>-1.485445</td>
      <td>0.009893</td>
      <td>1.373864</td>
    </tr>
    <tr>
      <th>175</th>
      <td>0.351313</td>
      <td>1.744744</td>
      <td>-0.389355</td>
      <td>0.151661</td>
      <td>1.422412</td>
      <td>-1.129824</td>
      <td>-1.344582</td>
      <td>0.550187</td>
      <td>-0.422075</td>
      <td>2.224236</td>
      <td>-1.612125</td>
      <td>-1.485445</td>
      <td>0.280575</td>
      <td>1.373864</td>
    </tr>
    <tr>
      <th>176</th>
      <td>0.225945</td>
      <td>0.227694</td>
      <td>0.012732</td>
      <td>0.151661</td>
      <td>1.422412</td>
      <td>-1.033684</td>
      <td>-1.354622</td>
      <td>1.356221</td>
      <td>-0.229346</td>
      <td>1.834923</td>
      <td>-1.568252</td>
      <td>-1.400699</td>
      <td>0.296498</td>
      <td>1.373864</td>
    </tr>
    <tr>
      <th>177</th>
      <td>1.429481</td>
      <td>1.583165</td>
      <td>1.365208</td>
      <td>1.502943</td>
      <td>-0.262708</td>
      <td>-0.392751</td>
      <td>-1.274305</td>
      <td>1.598032</td>
      <td>-0.422075</td>
      <td>1.791666</td>
      <td>-1.524378</td>
      <td>-1.428948</td>
      <td>-0.595160</td>
      <td>1.373864</td>
    </tr>
  </tbody>
</table>
<p>178 rows × 14 columns</p>
</div>




```python
st_scaled = pd.DataFrame(st_scaled, columns = data.columns)
pd.DataFrame(st_scaled)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>alcohol</th>
      <th>malic_acid</th>
      <th>ash</th>
      <th>alcalinity_of_ash</th>
      <th>magnesium</th>
      <th>total_phenols</th>
      <th>flavanoids</th>
      <th>nonflavanoid_phenols</th>
      <th>proanthocyanins</th>
      <th>color_intensity</th>
      <th>hue</th>
      <th>od280/od315_of_diluted_wines</th>
      <th>proline</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.554849</td>
      <td>-0.562250</td>
      <td>0.232053</td>
      <td>-1.169593</td>
      <td>1.913905</td>
      <td>0.808997</td>
      <td>1.034819</td>
      <td>-0.658865</td>
      <td>1.224884</td>
      <td>0.251717</td>
      <td>0.362177</td>
      <td>1.847920</td>
      <td>1.013009</td>
      <td>-1.213944</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.075503</td>
      <td>-0.499413</td>
      <td>-0.827996</td>
      <td>-2.490847</td>
      <td>0.018145</td>
      <td>0.568648</td>
      <td>0.733629</td>
      <td>-0.820072</td>
      <td>-0.544721</td>
      <td>-0.293321</td>
      <td>0.406051</td>
      <td>1.113449</td>
      <td>0.965242</td>
      <td>-1.213944</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.213408</td>
      <td>0.021231</td>
      <td>1.109334</td>
      <td>-0.268738</td>
      <td>0.088358</td>
      <td>0.808997</td>
      <td>1.215533</td>
      <td>-0.497658</td>
      <td>2.135968</td>
      <td>0.269020</td>
      <td>0.318304</td>
      <td>0.788587</td>
      <td>1.395148</td>
      <td>-1.213944</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.730365</td>
      <td>-0.346811</td>
      <td>0.487926</td>
      <td>-0.809251</td>
      <td>0.930918</td>
      <td>2.491446</td>
      <td>1.466525</td>
      <td>-0.981279</td>
      <td>1.032155</td>
      <td>1.186068</td>
      <td>-0.427544</td>
      <td>1.184071</td>
      <td>2.334574</td>
      <td>-1.213944</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.313703</td>
      <td>0.227694</td>
      <td>1.840403</td>
      <td>0.451946</td>
      <td>1.281985</td>
      <td>0.808997</td>
      <td>0.663351</td>
      <td>0.227773</td>
      <td>0.401404</td>
      <td>-0.319276</td>
      <td>0.362177</td>
      <td>0.449601</td>
      <td>-0.037874</td>
      <td>-1.213944</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>173</th>
      <td>0.902934</td>
      <td>2.974543</td>
      <td>0.305159</td>
      <td>0.301803</td>
      <td>-0.332922</td>
      <td>-0.985614</td>
      <td>-1.424900</td>
      <td>1.275618</td>
      <td>-0.930179</td>
      <td>1.142811</td>
      <td>-1.392758</td>
      <td>-1.231206</td>
      <td>-0.021952</td>
      <td>1.373864</td>
    </tr>
    <tr>
      <th>174</th>
      <td>0.514292</td>
      <td>1.412609</td>
      <td>0.414820</td>
      <td>1.052516</td>
      <td>0.158572</td>
      <td>-0.793334</td>
      <td>-1.284344</td>
      <td>0.550187</td>
      <td>-0.316950</td>
      <td>0.969783</td>
      <td>-1.129518</td>
      <td>-1.485445</td>
      <td>0.009893</td>
      <td>1.373864</td>
    </tr>
    <tr>
      <th>175</th>
      <td>0.351313</td>
      <td>1.744744</td>
      <td>-0.389355</td>
      <td>0.151661</td>
      <td>1.422412</td>
      <td>-1.129824</td>
      <td>-1.344582</td>
      <td>0.550187</td>
      <td>-0.422075</td>
      <td>2.224236</td>
      <td>-1.612125</td>
      <td>-1.485445</td>
      <td>0.280575</td>
      <td>1.373864</td>
    </tr>
    <tr>
      <th>176</th>
      <td>0.225945</td>
      <td>0.227694</td>
      <td>0.012732</td>
      <td>0.151661</td>
      <td>1.422412</td>
      <td>-1.033684</td>
      <td>-1.354622</td>
      <td>1.356221</td>
      <td>-0.229346</td>
      <td>1.834923</td>
      <td>-1.568252</td>
      <td>-1.400699</td>
      <td>0.296498</td>
      <td>1.373864</td>
    </tr>
    <tr>
      <th>177</th>
      <td>1.429481</td>
      <td>1.583165</td>
      <td>1.365208</td>
      <td>1.502943</td>
      <td>-0.262708</td>
      <td>-0.392751</td>
      <td>-1.274305</td>
      <td>1.598032</td>
      <td>-0.422075</td>
      <td>1.791666</td>
      <td>-1.524378</td>
      <td>-1.428948</td>
      <td>-0.595160</td>
      <td>1.373864</td>
    </tr>
  </tbody>
</table>
<p>178 rows × 14 columns</p>
</div>




```python
round(st_scaled.describe(), 2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>alcohol</th>
      <th>malic_acid</th>
      <th>ash</th>
      <th>alcalinity_of_ash</th>
      <th>magnesium</th>
      <th>total_phenols</th>
      <th>flavanoids</th>
      <th>nonflavanoid_phenols</th>
      <th>proanthocyanins</th>
      <th>color_intensity</th>
      <th>hue</th>
      <th>od280/od315_of_diluted_wines</th>
      <th>proline</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-0.00</td>
      <td>-0.00</td>
      <td>-0.00</td>
      <td>-0.00</td>
      <td>-0.00</td>
      <td>0.00</td>
      <td>-0.00</td>
      <td>0.00</td>
      <td>-0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>-0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-2.46</td>
      <td>-1.43</td>
      <td>-3.68</td>
      <td>-2.67</td>
      <td>-2.09</td>
      <td>-2.11</td>
      <td>-1.70</td>
      <td>-1.87</td>
      <td>-2.07</td>
      <td>-1.63</td>
      <td>-2.09</td>
      <td>-1.90</td>
      <td>-1.49</td>
      <td>-1.21</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.79</td>
      <td>-0.66</td>
      <td>-0.57</td>
      <td>-0.69</td>
      <td>-0.82</td>
      <td>-0.89</td>
      <td>-0.83</td>
      <td>-0.74</td>
      <td>-0.60</td>
      <td>-0.80</td>
      <td>-0.77</td>
      <td>-0.95</td>
      <td>-0.78</td>
      <td>-1.21</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.08</td>
      <td>-0.42</td>
      <td>-0.02</td>
      <td>0.00</td>
      <td>-0.12</td>
      <td>0.10</td>
      <td>0.11</td>
      <td>-0.18</td>
      <td>-0.06</td>
      <td>-0.16</td>
      <td>0.03</td>
      <td>0.24</td>
      <td>-0.23</td>
      <td>0.08</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.84</td>
      <td>0.67</td>
      <td>0.70</td>
      <td>0.60</td>
      <td>0.51</td>
      <td>0.81</td>
      <td>0.85</td>
      <td>0.61</td>
      <td>0.63</td>
      <td>0.49</td>
      <td>0.71</td>
      <td>0.79</td>
      <td>0.76</td>
      <td>1.37</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.21</td>
      <td>3.11</td>
      <td>3.16</td>
      <td>3.15</td>
      <td>4.37</td>
      <td>2.54</td>
      <td>3.06</td>
      <td>2.40</td>
      <td>3.49</td>
      <td>3.44</td>
      <td>3.30</td>
      <td>1.96</td>
      <td>2.97</td>
      <td>1.37</td>
    </tr>
  </tbody>
</table>
</div>



### 로버스트 스케일링


```python
rb_scaler = RobustScaler()
rb_scaled = rb_scaler.fit_transform(data)
rb_scaled = pd.DataFrame(rb_scaled, columns = data.columns)
```


```python
round(rb_scaled.describe(), 2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>alcohol</th>
      <th>malic_acid</th>
      <th>ash</th>
      <th>alcalinity_of_ash</th>
      <th>magnesium</th>
      <th>total_phenols</th>
      <th>flavanoids</th>
      <th>nonflavanoid_phenols</th>
      <th>proanthocyanins</th>
      <th>color_intensity</th>
      <th>hue</th>
      <th>od280/od315_of_diluted_wines</th>
      <th>proline</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-0.05</td>
      <td>0.32</td>
      <td>0.02</td>
      <td>-0.00</td>
      <td>0.09</td>
      <td>-0.06</td>
      <td>-0.06</td>
      <td>0.13</td>
      <td>0.05</td>
      <td>0.12</td>
      <td>-0.02</td>
      <td>-0.14</td>
      <td>0.15</td>
      <td>-0.03</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.62</td>
      <td>0.75</td>
      <td>0.79</td>
      <td>0.78</td>
      <td>0.75</td>
      <td>0.59</td>
      <td>0.60</td>
      <td>0.74</td>
      <td>0.82</td>
      <td>0.78</td>
      <td>0.68</td>
      <td>0.58</td>
      <td>0.65</td>
      <td>0.39</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-1.55</td>
      <td>-0.76</td>
      <td>-2.88</td>
      <td>-2.07</td>
      <td>-1.47</td>
      <td>-1.30</td>
      <td>-1.07</td>
      <td>-1.25</td>
      <td>-1.64</td>
      <td>-1.14</td>
      <td>-1.44</td>
      <td>-1.23</td>
      <td>-0.82</td>
      <td>-0.50</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.53</td>
      <td>-0.18</td>
      <td>-0.43</td>
      <td>-0.53</td>
      <td>-0.53</td>
      <td>-0.58</td>
      <td>-0.56</td>
      <td>-0.42</td>
      <td>-0.44</td>
      <td>-0.49</td>
      <td>-0.54</td>
      <td>-0.68</td>
      <td>-0.36</td>
      <td>-0.50</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.00</td>
      <td>-0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>-0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.47</td>
      <td>0.82</td>
      <td>0.57</td>
      <td>0.47</td>
      <td>0.47</td>
      <td>0.42</td>
      <td>0.44</td>
      <td>0.58</td>
      <td>0.56</td>
      <td>0.51</td>
      <td>0.46</td>
      <td>0.32</td>
      <td>0.64</td>
      <td>0.50</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.31</td>
      <td>2.66</td>
      <td>2.50</td>
      <td>2.44</td>
      <td>3.37</td>
      <td>1.44</td>
      <td>1.76</td>
      <td>1.91</td>
      <td>2.89</td>
      <td>2.79</td>
      <td>2.21</td>
      <td>0.99</td>
      <td>2.08</td>
      <td>0.50</td>
    </tr>
  </tbody>
</table>
</div>



### 최소-최대 스케일링


```python
mm_scaler = MinMaxScaler()
mm_scaled = mm_scaler.fit_transform(data)
mm_scaled = pd.DataFrame(mm_scaled, columns = data.columns)
round(mm_scaled.describe(), 2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>alcohol</th>
      <th>malic_acid</th>
      <th>ash</th>
      <th>alcalinity_of_ash</th>
      <th>magnesium</th>
      <th>total_phenols</th>
      <th>flavanoids</th>
      <th>nonflavanoid_phenols</th>
      <th>proanthocyanins</th>
      <th>color_intensity</th>
      <th>hue</th>
      <th>od280/od315_of_diluted_wines</th>
      <th>proline</th>
      <th>class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
      <td>178.00</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.53</td>
      <td>0.32</td>
      <td>0.54</td>
      <td>0.46</td>
      <td>0.32</td>
      <td>0.45</td>
      <td>0.36</td>
      <td>0.44</td>
      <td>0.37</td>
      <td>0.32</td>
      <td>0.39</td>
      <td>0.49</td>
      <td>0.33</td>
      <td>0.47</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.22</td>
      <td>0.22</td>
      <td>0.15</td>
      <td>0.17</td>
      <td>0.16</td>
      <td>0.22</td>
      <td>0.21</td>
      <td>0.23</td>
      <td>0.18</td>
      <td>0.20</td>
      <td>0.19</td>
      <td>0.26</td>
      <td>0.22</td>
      <td>0.39</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.36</td>
      <td>0.17</td>
      <td>0.45</td>
      <td>0.34</td>
      <td>0.20</td>
      <td>0.26</td>
      <td>0.18</td>
      <td>0.26</td>
      <td>0.26</td>
      <td>0.17</td>
      <td>0.25</td>
      <td>0.24</td>
      <td>0.16</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.54</td>
      <td>0.22</td>
      <td>0.53</td>
      <td>0.46</td>
      <td>0.30</td>
      <td>0.47</td>
      <td>0.38</td>
      <td>0.40</td>
      <td>0.36</td>
      <td>0.29</td>
      <td>0.39</td>
      <td>0.55</td>
      <td>0.28</td>
      <td>0.50</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.71</td>
      <td>0.46</td>
      <td>0.64</td>
      <td>0.56</td>
      <td>0.40</td>
      <td>0.63</td>
      <td>0.53</td>
      <td>0.58</td>
      <td>0.49</td>
      <td>0.42</td>
      <td>0.52</td>
      <td>0.70</td>
      <td>0.50</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
</div>



### 스케일링 방식 선택

#### 1. 표준화 스케일링
    데이터에 아웃라이어가 존재할 때 아웃라이어의 영향을 받는다.
    평균 0, 분산 1이 되게끔 분포시키기 때문에 데이터의 긴존 분포 형태가 사라진다.
    정규분포를 따르는 결과물을 가져온다.

#### 2. 로버스트 스케일링
    아웃라이어에 영향을 받지 않는다.
    변환된 데이터의 범위는 표준화 스케일링, 최소-최대 스케일링보다 넓게 나타난다.

#### 3. 최소-최대 스케일링
    아웃라이어의 영향을 받는다.
    데이터의 기존 분포를 가장 있는 그대로 담아내며 스케일만 변화 시킨다.(데이터의 변화가 적다)
    데이터의 범위는 0~1로 나타난다.

### 스케일링 적용


```python
from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(data.drop('class', axis=1),data['class'], test_size=0.2, random_state=100)
mm_scaler = MinMaxScaler()
mm_scaler.fit(X_train)

X_train_scaled = mm_scaler.transform(X_train)
X_test_scaled = mm_scaler.transform(X_test)
```

### K-최근접 이웃 알고리즘
    k-최근접 이웃 알고리즘은 예측할 데이터와 기존 데이터의 거리만 계산하기 때문에 데이터 위치를 스크린샷할뿐
    그외의 별다른 학습을 하지 않습니다.
    따라서 fit과정은 빠르지만 predict과정은 상당한 시간이 걸릴 수 있습니다.


```python
from sklearn.neighbors import KNeighborsClassifier
knn = KNeighborsClassifier()
knn.fit(X_train_scaled, y_train)
pred = knn.predict(X_test_scaled)
pred
```




    array([1, 2, 0, 1, 2, 2, 1, 2, 1, 0, 2, 0, 2, 2, 2, 0, 2, 0, 1, 0, 2, 0,
           2, 1, 0, 0, 1, 1, 1, 2, 2, 1, 0, 1, 2, 2], dtype=int64)




```python
from sklearn.metrics import accuracy_score
accuracy_score(y_test, pred)
```




    0.8888888888888888




```python
knn = KNeighborsClassifier(n_neighbors=20)
knn.fit(X_train_scaled, y_train)
pred = knn.predict(X_test_scaled)
accuracy_score(y_test, pred)
```




    0.9722222222222222


